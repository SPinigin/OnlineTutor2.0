@{
    ViewData["Title"] = "Экспорт данных";
}

@await Html.PartialAsync("_AdminNav")

<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h2><i class="fas fa-file-export text-primary"></i> Экспорт данных</h2>
        <p class="text-muted">Экспорт данных системы в Excel или CSV формат</p>
    </div>
    <div>
        <a asp-action="Index" class="btn btn-outline-secondary">
            <i class="fas fa-arrow-left"></i> К дашборду
        </a>
    </div>
</div>


<div class="row mb-4">

    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">
                    <i class="fas fa-users"></i> Пользователи
                </h5>
            </div>
            <div class="card-body">
                <p class="text-muted">
                    Экспорт пользователей системы с их данными, ролями и статусами.
                </p>
                <ul class="small text-muted">
                    <li>Личные данные</li>
                    <li>Email и телефон</li>
                    <li>Роли</li>
                    <li>Статус аккаунта</li>
                    <li>Дата регистрации</li>
                </ul>
            </div>
            <div class="card-footer">
                <div class="btn-group w-100">
                    <a asp-action="ExportUsers" asp-route-format="excel"
                       class="btn btn-success">
                        <i class="fas fa-file-excel"></i> Excel
                    </a>
                    <a asp-action="ExportUsers" asp-route-format="csv"
                       class="btn btn-outline-success">
                        <i class="fas fa-file-csv"></i> CSV
                    </a>
                </div>
            </div>
        </div>
    </div>


    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">
                    <i class="fas fa-chalkboard-teacher"></i> Учителя
                </h5>
            </div>
            <div class="card-body">
                <p class="text-muted">
                    Экспорт учителей с информацией о профилях и активности.
                </p>
                <ul class="small text-muted">
                    <li>Профессиональные данные</li>
                    <li>Образование и опыт</li>
                    <li>Количество классов</li>
                    <li>Количество тестов</li>
                    <li>Статус модерации</li>
                </ul>
            </div>
            <div class="card-footer">
                <div class="btn-group w-100">
                    <a asp-action="ExportTeachers" asp-route-format="excel"
                       class="btn btn-success">
                        <i class="fas fa-file-excel"></i> Excel
                    </a>
                    <a asp-action="ExportTeachers" asp-route-format="csv"
                       class="btn btn-outline-success">
                        <i class="fas fa-file-csv"></i> CSV
                    </a>
                </div>
            </div>
        </div>
    </div>


    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0">
                    <i class="fas fa-user-graduate"></i> Ученики
                </h5>
            </div>
            <div class="card-body">
                <p class="text-muted">
                    Экспорт студентов со статистикой прохождения тестов.
                </p>
                <ul class="small text-muted">
                    <li>Школа и класс</li>
                    <li>Класс на платформе</li>
                    <li>Количество тестов</li>
                    <li>Средний балл</li>
                    <li>Активность</li>
                </ul>
            </div>
            <div class="card-footer">
                <div class="btn-group w-100">
                    <a asp-action="ExportStudents" asp-route-format="excel"
                       class="btn btn-success">
                        <i class="fas fa-file-excel"></i> Excel
                    </a>
                    <a asp-action="ExportStudents" asp-route-format="csv"
                       class="btn btn-outline-success">
                        <i class="fas fa-file-csv"></i> CSV
                    </a>
                </div>
            </div>
        </div>
    </div>


    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100">
            <div class="card-header bg-warning text-dark">
                <h5 class="mb-0">
                    <i class="fas fa-graduation-cap"></i> Классы
                </h5>
            </div>
            <div class="card-body">
                <p class="text-muted">
                    Экспорт классов с информацией о студентах и тестах.
                </p>
                <ul class="small text-muted">
                    <li>Название и описание</li>
                    <li>Учитель класса</li>
                    <li>Количество студентов</li>
                    <li>Тесты по типам</li>
                    <li>Дата создания</li>
                </ul>
            </div>
            <div class="card-footer">
                <div class="btn-group w-100">
                    <a asp-action="ExportClasses" asp-route-format="excel"
                       class="btn btn-success">
                        <i class="fas fa-file-excel"></i> Excel
                    </a>
                    <a asp-action="ExportClasses" asp-route-format="csv"
                       class="btn btn-outline-success">
                        <i class="fas fa-file-csv"></i> CSV
                    </a>
                </div>
            </div>
        </div>
    </div>


    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">
                    <i class="fas fa-tasks"></i> Тесты
                </h5>
            </div>
            <div class="card-body">
                <p class="text-muted">
                    Экспорт тестов всех типов с метаданными.
                </p>
                <ul class="small text-muted">
                    <li>Название и тип теста</li>
                    <li>Автор (учитель)</li>
                    <li>Класс</li>
                    <li>Количество вопросов</li>
                    <li>Количество результатов</li>
                </ul>
            </div>
            <div class="card-footer">
                <div class="btn-group w-100">
                    <a asp-action="ExportTests" asp-route-format="excel"
                       class="btn btn-success">
                        <i class="fas fa-file-excel"></i> Excel
                    </a>
                    <a asp-action="ExportTests" asp-route-format="csv"
                       class="btn btn-outline-success">
                        <i class="fas fa-file-csv"></i> CSV
                    </a>
                </div>
            </div>
        </div>
    </div>


    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100">
            <div class="card-header bg-danger text-white">
                <h5 class="mb-0">
                    <i class="fas fa-chart-line"></i> Результаты
                </h5>
            </div>
            <div class="card-body">
                <p class="text-muted">
                    Экспорт всех результатов прохождения тестов студентами.
                </p>
                <ul class="small text-muted">
                    <li>Тест и студент</li>
                    <li>Баллы и процент</li>
                    <li>Время прохождения</li>
                    <li>Статус завершения</li>
                    <li>Дата прохождения</li>
                </ul>
            </div>
            <div class="card-footer">
                <div class="btn-group w-100">
                    <a asp-action="ExportTestResults" asp-route-format="excel"
                       class="btn btn-success">
                        <i class="fas fa-file-excel"></i> Excel
                    </a>
                    <a asp-action="ExportTestResults" asp-route-format="csv"
                       class="btn btn-outline-success">
                        <i class="fas fa-file-csv"></i> CSV
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="row mb-4">

    <div class="col-md-6">
        <div class="card h-100">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0">
                    <i class="fas fa-history"></i> Журнал действий
                </h5>
            </div>
            <div class="card-body">
                <p class="text-muted">
                    Экспорт журнала действий администраторов (последние 10 000 записей).
                </p>
                <ul class="small text-muted">
                    <li>Дата и время</li>
                    <li>Администратор</li>
                    <li>Действие</li>
                    <li>Тип сущности</li>
                    <li>Детали и IP адрес</li>
                </ul>
            </div>
            <div class="card-footer">
                <div class="btn-group w-100">
                    <a asp-action="ExportAuditLogs" asp-route-format="excel"
                       class="btn btn-success">
                        <i class="fas fa-file-excel"></i> Excel
                    </a>
                    <a asp-action="ExportAuditLogs" asp-route-format="csv"
                       class="btn btn-outline-success">
                        <i class="fas fa-file-csv"></i> CSV
                    </a>
                </div>
            </div>
        </div>
    </div>


    <div class="col-md-6">
        <div class="card h-100 border-danger">
            <div class="card-header bg-danger text-white">
                <h5 class="mb-0">
                    <i class="fas fa-database"></i> Полный экспорт системы
                </h5>
            </div>
            <div class="card-body">
                <p class="text-muted">
                    Создаёт один Excel файл со всеми данными на отдельных листах:
                </p>
                <ul class="small text-muted mb-0">
                    <li>Пользователи</li>
                    <li>Учителя и студенты</li>
                    <li>Классы</li>
                    <li>Все тесты</li>
                    <li>Результаты тестов</li>
                    <li>Журнал действий</li>
                </ul>
            </div>
            <div class="card-footer">
                <a asp-action="ExportFullSystem"
                   class="btn btn-danger w-100"
                   onclick="return confirm('Экспорт всех данных может занять несколько минут. Продолжить?')">
                    <i class="fas fa-database"></i> Экспортировать всё (Excel)
                </a>
            </div>
        </div>
    </div>
</div>
